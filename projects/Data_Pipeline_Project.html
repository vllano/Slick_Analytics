<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Victor Llano | Automated KPI Reporting Pipeline & Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #0052cc; /* A deeper, more professional blue */
            --secondary-color: #172b4d; /* Dark slate blue for text */
            --accent-color: #00b8d9; /* A vibrant cyan for highlights */
            --light-bg: #f4f5f7; /* Lighter grey for subtle contrast */
            --white-bg: #ffffff;
            --border-color: #dee2e6;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --border-radius: 8px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--light-bg);
            color: var(--secondary-color);
            line-height: 1.7;
        }

        .container-fluid { max-width: 1200px; }

        .header {
            background: var(--secondary-color);
            color: var(--white-bg);
            padding: 4rem 2rem;
            text-align: left;
            border-radius: var(--border-radius);
            margin-bottom: 3rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header h1 { font-weight: 700; }
        .header .lead { max-width: 55ch; }
        .header-icon { font-size: 6rem; opacity: 0.2; transform: rotate(-15deg); }

        .section-title {
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--primary-color);
            display: inline-block;
        }

        .card {
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: none;
            transition: all 0.3s ease;
            background-color: var(--white-bg);
        }
        .card:hover { box-shadow: var(--shadow); transform: translateY(-5px); }
        
        .kpi-card { padding: 1.5rem; text-align: center; }
        .kpi-icon { 
            font-size: 2.5rem; 
            margin-bottom: 1rem; 
            color: var(--primary-color);
            background-color: #e6efff;
            padding: 1rem;
            border-radius: 50%;
            display: inline-block;
        }
        .kpi-label { font-weight: 500; color: #6c757d; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px;}
        .kpi-value { font-size: 2rem; font-weight: 700; color: var(--secondary-color); }

        .code-block {
            background-color: #1e1e1e; /* Standard dark theme color */
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            font-family: 'Roboto Mono', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            border: 1px solid #333;
        }
        
        .code-block .comment { color: #6a9955; } /* Green for comments */
        .code-block .keyword { color: #569cd6; } /* Blue for keywords */
        .code-block .function { color: #dcdcaa; } /* Yellow for functions */
        .code-block .string { color: #ce9178; } /* Orange for strings */
        .code-block .number { color: #b5cea8; } /* Light green for numbers */
        .code-block .identifier { color: #9cdcfe; } /* Light blue for identifiers */
        .code-block .object { color: #4ec9b0; } /* Teal for objects */
        
        .email-preview { border: 1px solid var(--border-color); border-radius: var(--border-radius); overflow: hidden; background-color: var(--white-bg); }
        .email-preview-header { background: #e9ecef; padding: 0.75rem 1rem; border-bottom: 1px solid var(--border-color);}
        .email-preview-body { padding: 1rem; }
        .email-report-table { width: 100%; border-collapse: collapse; font-size: 0.85em; }
        .email-report-table th, .email-report-table td { border: 1px solid #dee2e6; padding: 8px; text-align: center; vertical-align: middle; }
        .email-report-table th { background-color: #f8f9fa; font-weight: bold; }
        .email-report-table thead th[colspan] { color: white; }
        
        .dashboard-preview { border: 1px solid var(--border-color); border-radius: var(--border-radius); background: var(--white-bg); }
        .dashboard-preview-header { padding: 0.75rem 1rem; background: #e9ecef; border-bottom: 1px solid var(--border-color); }
        .dashboard-preview-body { padding: 1rem; background-color: #f8f9fa; }
        
        .text-bold { font-weight: 700; }
        .section { margin-bottom: 4rem; }

        /* New Modern Flowchart Styles */
        .flowchart-container {
            background-color: var(--white-bg);
            padding: 2rem 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
        }
        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }
        .flow-row, .flow-branches {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            width: 100%;
        }
        .flow-node {
            background-color: #ffffff;
            border: 1px solid #dfe1e6;
            border-radius: 6px;
            padding: 0.8rem 1.2rem;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--secondary-color);
            box-shadow: 0 1px 3px rgba(23,43,77,0.08);
            flex-shrink: 0;
            transition: all 0.2s ease-in-out;
        }
        .flow-node:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(23,43,77,0.12);
        }
        .flow-node i {
            color: var(--primary-color);
            margin-right: 0.5rem;
            font-size: 1.1rem;
            vertical-align: text-bottom;
        }
        .flow-connector { color: #a5adba; }
        .flow-connector svg { display: block; }
        .flow-junction {
            position: relative;
            height: 40px;
            width: 100%;
            min-width: 500px;
        }
        .flow-junction-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Responsive Flowchart */
        @media (max-width: 991px) {
            .flow-row, .flow-branches {
                flex-direction: column;
            }
            .flow-connector.horizontal {
                transform: rotate(90deg);
                margin: 0.5rem 0;
            }
            .flow-branches {
                align-items: center;
            }
            .flow-junction {
                display: none;
            }
        }
    </style>
</head>
<body>

    <div class="container-fluid my-5">

        <header class="header">
            <div>
                <h1 class="display-4">Automated KPI Reporting Pipeline</h1>
                <p class="lead">Designed and deployed an end-to-end data pipeline that automates prototype testing analysis and stakeholder reporting, converting raw data into actionable business intelligence.</p>
            </div>
            <i class="bi bi-diagram-3-fill header-icon d-none d-md-block"></i>
        </header>

        <section id="summary" class="section">
            <h2 class="section-title">Project Overview</h2>
            <div class="card">
                <div class="card-body p-4 p-md-5">
                    <p><strong class="text-bold">Situation:</strong> The Field Operations team was manually tracking prototype testing performance. This process was time-consuming, error-prone, and failed to provide timely insights for strategic decision-making.</p>
                    <p><strong class="text-bold">Task:</strong> My objective was to design a fully automated solution to measure testing throughput and deliver these insights to stakeholders through both automated reports and an interactive dashboard.</p>
                    <p><strong class="text-bold">Action:</strong> I architected a solution based on a central source of truth:</p>
                    <ol class="mt-2">
                        <li><strong>SQL Data Engine:</strong> Developed a sophisticated SQL query to ingest, clean, and transform raw log data, materializing the results in a clean, aggregated data table in our warehouse.</li>
                        <li><strong>Automated Email Delivery:</strong> Connected a Google Sheet to the final data table, then used Google Apps Script to build a dynamic HTML summary report and email it to stakeholders on a set schedule.</li>
                        <li><strong>Live BI Dashboard:</strong> Connected Looker Studio directly to the aggregated data table, providing stakeholders with a live, interactive dashboard for self-service data exploration.</li>
                    </ol>
                    
                    <hr class="my-4">
                    <h5 class="text-center mb-4 fw-bold">Pipeline Architecture</h5>
                    <div class="flowchart-container">
                        <div class="flowchart">
                            <div class="flow-row">
                                <div class="flow-node"><i class="bi bi-database"></i>Raw Logs</div>
                                <div class="flow-connector horizontal">
                                    <svg width="50" height="20" viewBox="0 0 50 20">
                                        <defs>
                                            <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                                                <path d="M 0 0 L 10 5 L 0 10 z" fill="#a5adba"></path>
                                            </marker>
                                        </defs>
                                        <line x1="5" y1="10" x2="45" y2="10" stroke="#a5adba" stroke-width="2" marker-end="url(#arrow)"></line>
                                    </svg>
                                </div>
                                <div class="flow-node"><i class="bi bi-filetype-sql"></i>SQL Engine</div>
                                <div class="flow-connector horizontal">
                                    <svg width="50" height="20" viewBox="0 0 50 20">
                                        <line x1="5" y1="10" x2="45" y2="10" stroke="#a5adba" stroke-width="2" marker-end="url(#arrow)"></line>
                                    </svg>
                                </div>
                                <div class="flow-node"><i class="bi bi-table"></i>Aggregated Table</div>
                            </div>
                            
                            <div class="flow-junction d-none d-lg-block">
                                <svg class="flow-junction-svg" preserveAspectRatio="none">
                                     <line x1="50%" y1="0" x2="50%" y2="20" stroke="#a5adba" stroke-width="2"></line>
                                     <line x1="25%" y1="20" x2="75%" y2="20" stroke="#a5adba" stroke-width="2"></line>
                                     <line x1="25%" y1="20" x2="25%" y2="40" stroke="#a5adba" stroke-width="2" marker-end="url(#arrow)"></line>
                                     <line x1="75%" y1="20" x2="75%" y2="40" stroke="#a5adba" stroke-width="2" marker-end="url(#arrow)"></line>
                                </svg>
                            </div>
                            
                            <div class="flow-branches">
                                <div class="flow-row">
                                    <div class="flow-node"><i class="bi bi-file-earmark-spreadsheet"></i>Google Sheet</div>
                                    <div class="flow-connector horizontal">
                                        <svg width="50" height="20" viewBox="0 0 50 20">
                                            <line x1="5" y1="10" x2="45" y2="10" stroke="#a5adba" stroke-width="2" marker-end="url(#arrow)"></line>
                                        </svg>
                                    </div>
                                    <div class="flow-node"><i class="bi bi-envelope-at"></i>Email Report</div>
                                </div>
                                <div class="flow-row">
                                    <div class="flow-node"><i class="bi bi-bar-chart-line"></i>Looker Studio</div>
                                    <div class="flow-connector horizontal">
                                        <svg width="50" height="20" viewBox="0 0 50 20">
                                            <line x1="5" y1="10" x2="45" y2="10" stroke="#a5adba" stroke-width="2" marker-end="url(#arrow)"></line>
                                        </svg>
                                    </div>
                                    <div class="flow-node"><i class="bi bi-display"></i>Live Dashboard</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="mt-5 mb-3">
                    
                    <p class="mt-4"><strong class="text-bold">Result:</strong> The solution provided two methods of data delivery: a 'push' report via automated email for high-level updates, and a 'pull' resource via a live dashboard for interactive deep-dives. This completely eliminated manual reporting, saving approximately 5 hours per week while providing 100% accurate, timely data.</p>
                </div>
            </div>
        </section>

        <section id="impact-kpis" class="section">
            <h2 class="section-title">Quantified Impact</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card kpi-card h-100">
                        <i class="bi bi-clock-history kpi-icon"></i>
                        <div class="kpi-label">Hours Saved Weekly</div>
                        <div class="kpi-value">~5 Hours</div>
                        <p class="text-muted small mb-0">Eliminated all manual data processing and report creation.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card kpi-card h-100">
                        <i class="bi bi-arrow-repeat kpi-icon"></i>
                        <div class="kpi-label">Process Automation</div>
                        <div class="kpi-value">100%</div>
                        <p class="text-muted small mb-0">From raw data ingestion to final email delivery.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card kpi-card h-100">
                        <i class="bi bi-check-circle-fill kpi-icon"></i>
                        <div class="kpi-label">Data Accuracy</div>
                        <div class="kpi-value">>99.9%</div>
                        <p class="text-muted small mb-0">Eradicated an estimated 8% error rate from manual processes.</p>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-5">

        <section id="analysis" class="section">
            <h2 class="section-title">The Data Engine (SQL)</h2>
            <p class="lead mb-4">The pipeline's core is a SQL query that transforms raw event logs into meaningful metrics. The key challenge was to accurately define and count a "test session," as a single test could generate multiple logs. Without proper sessionization, we would have over-counted our activities by as much as 200%, giving a false sense of progress. My logic uses window functions (`LAG`, `SUM OVER`) to group these logs into unique sessions based on a 2-minute time delta.</p>

            <h4 class="mb-3 mt-5 fw-bold">Data Sources</h4>
            <p class="text-muted">The query pulls from two primary sources: a raw log of survey metadata and a table of monthly targets.</p>
            
            <div class="card mb-4">
                <div class="card-header fw-bold">1. survey_metadata (Raw Logs)</div>
                <div class="table-responsive">
                    <table class="table data-table table-striped table-bordered mb-0">
                        <thead>
                            <tr><th>survey_start_timestamp_millis</th><th>locale</th><th>author</th><th>tags</th><th>valid_survey</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>1661511276990</td><td>JP/HUB_A/APAC</td><td>author_1</td><td>["test_walking_stroller", "pocket_left_front"]</td><td>TRUE</td></tr>
                            <tr><td>1621530104282</td><td>US/HUB_B/NA</td><td>author_2</td><td>["test_biking_backpack", "outdoor_mall"]</td><td>TRUE</td></tr>
                            <tr><td>1711642395541</td><td>US/HUB_B/NA</td><td>author_3</td><td>["test_running_backpack", "tree_cover"]</td><td>TRUE</td></tr>
                            <tr><td>1630487854382</td><td>DE/HUB_C/EMEA</td><td>author_4</td><td>["test_walking_stroller", "parking_lot"]</td><td>FALSE</td></tr>
                            <tr><td>1727436586154</td><td>ES/HUB_C/EMEA</td><td>author_5</td><td>["bike_handrail", "test_biking_backpack"]</td><td>TRUE</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header fw-bold">2. monthly_survey_targets</div>
                <div class="table-responsive">
                    <table class="table data-table table-striped table-bordered mb-0">
                        <thead>
                            <tr><th>hub</th><th>test_type</th><th>target</th><th>month_year</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>HUB_A</td><td>Test A</td><td>24</td><td>January 2025</td></tr>
                            <tr><td>HUB_A</td><td>Test B</td><td>144</td><td>January 2025</td></tr>
                            <tr><td>HUB_B</td><td>Test A</td><td>48</td><td>March 2025</td></tr>
                            <tr><td>HUB_B</td><td>Test C</td><td>64</td><td>March 2025</td></tr>
                            <tr><td>HUB_C</td><td>Test D</td><td>120</td><td>April 2025</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <h4 class="mb-3 mt-5 fw-bold">SQL Transformation Logic</h4>
            <pre class="code-block"><code class="language-sql"><span class="comment">-- This query transforms raw logs into an aggregated performance summary,
-- then exports it to a Google Sheet for the reporting script.</span>
<span class="keyword">EXPORT</span> <span class="keyword">DATA</span> <span class="keyword">OPTIONS</span>(...) <span class="keyword">AS</span> (

<span class="comment">-- CTE 1: Clean and standardize raw data, including timezone conversion</span>
<span class="keyword">WITH</span> <span class="identifier">cleaned_data</span> <span class="keyword">AS</span> (
  <span class="keyword">SELECT</span>
    <span class="function">FORMAT_TIMESTAMP</span>(<span class="string">'%Y-%m-%d %H:%M:%S'</span>, ..., <span class="string">'America/Los_Angeles'</span>) <span class="keyword">AS</span> survey_start_datetime,
    <span class="function">SPLIT</span>(<span class="identifier">locale</span>, <span class="string">'/'</span>)[<span class="function">SAFE_OFFSET</span>(<span class="number">0</span>)] <span class="keyword">AS</span> country_code,
    <span class="function">SPLIT</span>(<span class="identifier">locale</span>, <span class="string">'/'</span>)[<span class="function">SAFE_OFFSET</span>(<span class="number">1</span>)] <span class="keyword">AS</span> hub,
    <span class="keyword">CASE</span>
      <span class="keyword">WHEN</span> <span class="function">ARRAY_TO_STRING</span>(<span class="identifier">tags</span>, <span class="string">';'</span>) <span class="keyword">LIKE</span> <span class="string">'%Running%'</span> <span class="keyword">THEN</span> <span class="string">'Test A'</span>
      <span class="keyword">WHEN</span> <span class="function">ARRAY_TO_STRING</span>(<span class="identifier">tags</span>, <span class="string">';'</span>) <span class="keyword">LIKE</span> <span class="string">'%Walking%'</span> <span class="keyword">THEN</span> <span class="string">'Test B'</span>
      <span class="keyword">WHEN</span> <span class="function">ARRAY_TO_STRING</span>(<span class="identifier">tags</span>, <span class="string">';'</span>) <span class="keyword">LIKE</span> <span class="string">'%Biking%'</span> <span class="keyword">THEN</span> <span class="string">'Test C'</span>
    <span class="keyword">ELSE</span> <span class="identifier">program</span> <span class="keyword">END</span> <span class="keyword">AS</span> test_type,
  <span class="keyword">FROM</span> <span class="identifier">survey_metadata</span>
),

<span class="comment">-- CTE 2: Use LAG() to get the timestamp of the previous event for each author</span>
<span class="identifier">session_tracking</span> <span class="keyword">AS</span> (
  <span class="keyword">SELECT</span> *,
    <span class="function">LAG</span>(<span class="function">CAST</span>(<span class="identifier">survey_start_datetime</span> <span class="keyword">AS</span> <span class="keyword">TIMESTAMP</span>), <span class="number">1</span>) <span class="keyword">OVER</span> (<span class="keyword">PARTITION BY</span> <span class="identifier">author</span> <span class="keyword">ORDER BY</span> <span class="identifier">survey_start_datetime</span>) <span class="keyword">AS</span> prev_timestamp
  <span class="keyword">FROM</span> <span class="identifier">cleaned_data</span>
  <span class="keyword">WHERE</span> <span class="identifier">valid_survey</span> <span class="keyword">IS</span> <span class="keyword">TRUE</span>
),

<span class="comment">-- CTE 3: Identify session starts. A new session begins if the time since the
-- last event is > 120s or if it's the author's first event.</span>
<span class="identifier">session_identification</span> <span class="keyword">AS</span> (
  <span class="keyword">SELECT</span> *,
    <span class="function">SUM</span>(<span class="keyword">CASE</span>
      <span class="keyword">WHEN</span> <span class="function">TIMESTAMP_DIFF</span>(<span class="function">CAST</span>(<span class="identifier">survey_start_datetime</span> <span class="keyword">AS</span> <span class="keyword">TIMESTAMP</span>), <span class="identifier">prev_timestamp</span>, <span class="keyword">SECOND</span>) > <span class="number">120</span> <span class="keyword">OR</span> <span class="identifier">prev_timestamp</span> <span class="keyword">IS NULL</span>
      <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span>
    <span class="keyword">END</span>) <span class="keyword">OVER</span> (
      <span class="keyword">PARTITION BY</span> <span class="identifier">author</span> <span class="keyword">ORDER BY</span> <span class="identifier">survey_start_datetime</span>
    ) <span class="keyword">AS</span> session_group
  <span class="keyword">FROM</span> <span class="identifier">session_tracking</span>
),

<span class="comment">-- CTE 4: Create a globally unique session ID for accurate counting</span>
<span class="identifier">unique_sessions</span> <span class="keyword">AS</span> (
  <span class="keyword">SELECT</span> *,
    <span class="function">CONCAT</span>(<span class="identifier">author</span>, <span class="string">'-'</span>, <span class="function">CAST</span>(<span class="identifier">session_group</span> <span class="keyword">AS</span> <span class="keyword">STRING</span>)) <span class="keyword">AS</span> unique_session_id
  <span class="keyword">FROM</span> <span class="identifier">session_identification</span>
),

<span class="comment">-- Final Aggregation: Count distinct sessions and join with targets</span>
<span class="identifier">final_aggregation</span> <span class="keyword">AS</span> (
  <span class="keyword">SELECT</span>
    <span class="function">FORMAT_DATE</span>(<span class="string">'%B %Y'</span>, <span class="function">DATE</span>(<span class="identifier">survey_start_datetime</span>)) <span class="keyword">AS</span> month_year,
    <span class="identifier">hub</span>,
    <span class="identifier">test_type</span>,
    <span class="function">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="identifier">unique_session_id</span>) <span class="keyword">AS</span> throughput
  <span class="keyword">FROM</span> <span class="identifier">unique_sessions</span>
  <span class="keyword">GROUP BY</span> <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>
)

<span class="keyword">SELECT</span>
  agg.<span class="identifier">month_year</span>,
  agg.<span class="identifier">hub</span>,
  agg.<span class="identifier">test_type</span>,
  tgt.<span class="identifier">target</span>,
  agg.<span class="identifier">throughput</span>,
  (tgt.<span class="identifier">target</span> - agg.<span class="identifier">throughput</span>) <span class="keyword">AS</span> remaining,
  agg.<span class="identifier">throughput</span> / tgt.<span class="identifier">target</span> <span class="keyword">AS</span> pct_met
<span class="keyword">FROM</span> <span class="identifier">final_aggregation</span> agg
<span class="keyword">LEFT JOIN</span> <span class="identifier">monthly_survey_targets</span> tgt
  <span class="keyword">ON</span> agg.<span class="identifier">month_year</span> = tgt.<span class="identifier">month_year</span>
  <span class="keyword">AND</span> agg.<span class="identifier">hub</span> = tgt.<span class="identifier">hub</span>
  <span class="keyword">AND</span> agg.<span class="identifier">test_type</span> = tgt.<span class="identifier">test_type</span>
<span class="keyword">WHERE</span> agg.<span class="identifier">month_year</span> = <span class="function">FORMAT_DATETIME</span>(<span class="string">'%B %Y'</span>, <span class="function">CURRENT_DATETIME</span>())
)</code></pre>

            <h4 class="mb-3 mt-5 fw-bold">SQL Query Output</h4>
            <p class="mb-3 text-muted">The SQL query generates a clean, aggregated table like the one below, This curated table acts as a single source of truth, feeding both the Google Sheet for the automated email reports and the BI dashboard for live, interactive analysis.</p>
            <div class="card">
                <div class="table-responsive">
                    <table class="table output-table table-striped table-bordered mb-0">
                        <thead>
                            <tr><th>month_year</th><th>hub</th><th>test_type</th><th>target</th><th>throughput</th><th>remaining</th><th>pct_met</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>August 2025</td><td>HUB_A</td><td>Test C</td><td>120</td><td>56</td><td>64</td><td>0.4667</td></tr>
                            <tr><td>August 2025</td><td>HUB_B</td><td>Test B</td><td>64</td><td>43</td><td>21</td><td>0.6719</td></tr>
                            <tr><td>August 2025</td><td>HUB_C</td><td>Test A</td><td>120</td><td>75</td><td>45</td><td>0.6250</td></tr>
                            <tr><td>August 2025</td><td>HUB_B</td><td>Test C</td><td>64</td><td>29</td><td>35</td><td>0.4531</td></tr>
                            <tr><td>August 2025</td><td>HUB_A</td><td>Test D</td><td>120</td><td>110</td><td>10</td><td>0.9167</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <hr class="my-5">

        <section id="delivery" class="section">
            <h2 class="section-title">The Delivery Engines</h2>

            <h4 class="mb-3 mt-4 fw-bold">1. BI Dashboard</h4>
            <p class="lead mb-4">The interactive dashboard connects directly to the central data table from the SQL query, visualizes KPIs using a suite of interactive charts and dynamic filters.</p>

            <h4 class="mb-3 mt-4 fw-bold">2. Automated Reporting Script (Google Apps Script)</h4>
            <p class="lead mb-4">This script connects to the Google Sheet populated by the SQL query, builds a clean, multi-header HTML email with conditional color-coding for at-a-glance insights, and distributes it to stakeholders via a time-based trigger.</p>
            <pre class="code-block"><code class="language-javascript"><span class="comment">/**
 * Main function to generate and send the weekly performance report.
 */</span>
<span class="keyword">function</span> <span class="function">sendWeeklyReport</span>() {
  <span class="keyword">const</span> <span class="identifier">sheetName</span> = <span class="string">'targets_vs_actuals'</span>;
  <span class="keyword">const</span> <span class="identifier">recipients</span> = [<span class="string">'stakeholder1@company.com'</span>, <span class="string">'stakeholder2@company.com'</span>];
  
  <span class="keyword">const</span> <span class="identifier">sheet</span> = <span class="object">SpreadsheetApp</span>.<span class="method">getActiveSpreadsheet</span>().<span class="method">getSheetByName</span>(<span class="identifier">sheetName</span>);
  <span class="keyword">if</span> (!<span class="identifier">sheet</span>) {
    <span class="object">Logger</span>.<span class="method">log</span>(<span class="string">'Error: Sheet not found.'</span>);
    <span class="keyword">return</span>;
  }
  <span class="keyword">const</span> <span class="identifier">data</span> = <span class="identifier">sheet</span>.<span class="method">getDataRange</span>().<span class="method">getValues</span>();
  
  <span class="keyword">const</span> <span class="identifier">reportDate</span> = <span class="object">Utilities</span>.<span class="method">formatDate</span>(<span class="keyword">new</span> <span class="object">Date</span>(), <span class="object">Session</span>.<span class="method">getScriptTimeZone</span>(), <span class="string">"MMMM dd, yyyy"</span>);
  <span class="keyword">const</span> <span class="identifier">emailSubject</span> = <span class="string">`Field Ops Performance Report - ${reportDate}`</span>;
  
  <span class="keyword">const</span> <span class="identifier">htmlBody</span> = <span class="function">buildHtmlBody</span>(<span class="identifier">data</span>, <span class="identifier">reportDate</span>);
  
  <span class="object">MailApp</span>.<span class="method">sendEmail</span>({
    to: <span class="identifier">recipients</span>.<span class="method">join</span>(<span class="string">','</span>),
    subject: <span class="identifier">emailSubject</span>,
    htmlBody: <span class="identifier">htmlBody</span>,
    name: <span class="string">'Automated Reporting System'</span>
  });
  <span class="object">Logger</span>.<span class="method">log</span>(<span class="string">'Report sent successfully.'</span>);
}

<span class="comment">/**
 * Builds the HTML for the email body.
 * @param {Array<Array<any>>} data The 2D array of data from the spreadsheet.
 * @param {string} reportDate The formatted date string for the report.
 * @return {string} The complete HTML body for the email.
 */</span>
<span class="keyword">function</span> <span class="function">buildHtmlBody</span>(<span class="identifier">data</span>, <span class="identifier">reportDate</span>) {
  <span class="keyword">let</span> <span class="identifier">introText</span> = `<span class="string">&lt;p&gt;Hello Team,&lt;br&gt;Please find the latest prototype testing performance report below.&lt;/p&gt;</span>`;
  <span class="keyword">let</span> <span class="identifier">table</span> = `<span class="string">&lt;table style="border-collapse: collapse; width: 100%;"&gt;...&lt;/table&gt;</span>`; <span class="comment">// (HTML table generation logic here)</span>

  <span class="comment">// Example of applying conditional formatting for a cell</span>
  <span class="keyword">const</span> <span class="identifier">percentageMet</span> = <span class="identifier">data</span>[<span class="identifier">row</span>][<span class="identifier">col</span>]; <span class="comment">// Assuming this is a float like 0.85</span>
  <span class="keyword">let</span> <span class="identifier">bgColor</span> = <span class="string">'#ffebee'</span>; <span class="comment">// Red (Poor)</span>
  <span class="keyword">if</span> (<span class="identifier">percentageMet</span> >= <span class="number">0.9</span>) {
    <span class="identifier">bgColor</span> = <span class="string">'#e8f5e9'</span>; <span class="comment">// Green (Good)</span>
  } <span class="keyword">else if</span> (<span class="identifier">percentageMet</span> >= <span class="number">0.7</span>) {
    <span class="identifier">bgColor</span> = <span class="string">'#fffde7'</span>; <span class="comment">// Yellow (Okay)</span>
  }
  <span class="keyword">const</span> <span class="identifier">formattedCell</span> = `<span class="string">&lt;td style="background-color: ${bgColor};"&gt;${(percentageMet * 100).toFixed(1)}%&lt;/td&gt;</span>`;

  <span class="keyword">return</span> <span class="identifier">introText</span> + <span class="identifier">table</span>;
}

<span class="comment">/**
 * Creates a time-driven trigger to run the report weekly.
 */</span>
<span class="keyword">function</span> <span class="function">createWeeklyTrigger</span>() {
  <span class="object">ScriptApp</span>.<span class="method">newTrigger</span>(<span class="string">'sendWeeklyReport'</span>)
    .<span class="method">timeBased</span>()
    .<span class="method">onWeekDay</span>(<span class="object">ScriptApp</span>.WeekDay.MONDAY)
    .<span class="method">atHour</span>(<span class="number">8</span>).<span class="method">inTimezone</span>(<span class="string">'America/Los_Angeles'</span>)
    .<span class="method">create</span>();
  <span class="object">Logger</span>.<span class="method">log</span>(<span class="string">'Weekly trigger created successfully.'</span>);
}
</code></pre>

        </section>
        
        <hr class="my-5">

        <section id="results" class="section">
            <h2 class="section-title">Final Deliverables</h2>
            <p class="lead mb-4">The project resulted in two key deliverables designed for different stakeholder needs: a scheduled email report for high-level awareness and a live dashboard for deep-dive analysis.</p>

            <h4 class="mb-3 mt-4 fw-bold">1. Live BI Dashboard</h4>
            <p class="text-muted">This "pull" resource connects Looker Studio directly to the central data table, empowering stakeholders to conduct self-service analysis with always-on, real-time data.</p>

            <h4 class="mb-3 mt-4 fw-bold">2. Automated Email Report</h4>
            <p class="text-muted">This "push" report is sent to leadership every Monday morning. It provides a consistent, at-a-glance view of performance against targets, sourced from the central data table.</p>

            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card email-preview">
                        <div class="email-preview-header">
                            <strong>Subject:</strong> Field Ops Performance Report - August 11, 2025
                        </div>
                        <div class="email-preview-body">
                            <p style="font-size: 0.95em;">Hello Team,<br>Please find the latest prototype testing performance report below.</p>
                            <table class="email-report-table">
                                <thead>
                                    <tr>
                                        <th rowspan="2">Hub</th>
                                        <th colspan="4" style="background-color: #4285f4;">Test A</th>
                                        <th colspan="4" style="background-color: #34a853;">Test B</th>
                                        <th colspan="4" style="background-color: #fbbc05;">Test C</th>
                                    </tr>
                                    <tr>
                                        <th>Target</th><th>Actual</th><th>Remain</th><th>% Met</th>
                                        <th>Target</th><th>Actual</th><th>Remain</th><th>% Met</th>
                                        <th>Target</th><th>Actual</th><th>Remain</th><th>% Met</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Hub A</td>
                                        <td>10</td><td>8</td><td>2</td><td style="background-color: #fffde7;">80.0%</td>
                                        <td>15</td><td>15</td><td>0</td><td style="background-color: #e8f5e9;">100.0%</td>
                                        <td>5</td><td>2</td><td>3</td><td style="background-color: #ffebee;">40.0%</td>
                                    </tr>
                                    <tr>
                                        <td>Hub B</td>
                                        <td>12</td><td>12</td><td>0</td><td style="background-color: #e8f5e9;">100.0%</td>
                                        <td>10</td><td>9</td><td>1</td><td style="background-color: #e8f5e9;">90.0%</td>
                                        <td>7</td><td>7</td><td>0</td><td style="background-color: #e8f5e9;">100.0%</td>
                                    </tr>
                                    <tr>
                                        <td>Hub C</td>
                                        <td>8</td><td>5</td><td>3</td><td style="background-color: #fffde7;">62.5%</td>
                                        <td>11</td><td>11</td><td>0</td><td style="background-color: #e8f5e9;">100.0%</td>
                                        <td>6</td><td>2</td><td>4</td><td style="background-color: #ffebee;">33.3%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-5">

        <section id="strategic-value" class="section">
            <h2 class="section-title">Strategic Value</h2>
            <p class="lead mb-5 text-center">This solution transformed a tedious administrative task into a strategic asset for the business.</p>
            <div class="row g-4 text-center">
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 p-3">
                        <div class="card-body d-flex flex-column">
                            <i class="bi bi-graph-up-arrow text-primary fs-2 mb-3"></i>
                            <h5 class="card-title fw-bold">Drives Accountability</h5>
                            <p class="card-text text-secondary mt-auto">Transparently tracks performance against established targets, fostering a culture of ownership.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 p-3">
                        <div class="card-body d-flex flex-column">
                            <i class="bi bi-bullseye text-primary fs-2 mb-3"></i>
                            <h5 class="card-title fw-bold">Optimizes Resources</h5>
                            <p class="card-text text-secondary mt-auto">Quickly identifies which hubs or test types are underperforming, allowing for targeted support.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 p-3">
                        <div class="card-body d-flex flex-column">
                            <i class="bi bi-lightbulb-fill text-primary fs-2 mb-3"></i>
                            <h5 class="card-title fw-bold">Enables Proactive Decisions</h5>
                            <p class="card-text text-secondary mt-auto">Shifts focus from reviewing past data to anticipating future needs and potential bottlenecks.</p>
                        </div>
                    </div>
                </div>
                 <div class="col-md-6 col-lg-3">
                    <div class="card h-100 p-3">
                        <div class="card-body d-flex flex-column">
                            <i class="bi bi-person-bounding-box text-primary fs-2 mb-3"></i>
                            <h5 class="card-title fw-bold">Empowers Self-Service</h5>
                            <p class="card-text text-secondary mt-auto">Allows stakeholders to explore data and answer their own questions without requesting custom reports.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="text-center text-muted mt-5 py-4 border-top">
            <p>&copy; 2025 Victor Llano | All rights reserved.</p>
        </footer>
    </div>
    
</body>
</html>